<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QuickNav - 快速导航平台</title>
  <!-- 引入外部资源 -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  
  <!-- Tailwind 配置 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#3b82f6', // 主色调：蓝色
            secondary: '#60a5fa', // 辅助色：浅蓝
            accent: '#1d4ed8', // 强调色：深蓝
            neutral: {
              50: '#f9fafb',
              100: '#f3f4f6',
              200: '#e5e7eb',
              300: '#d1d5db',
              400: '#9ca3af',
              500: '#6b7280',
              600: '#4b5563',
              700: '#374151',
              800: '#1f2937',
              900: '#111827',
            },
            danger: '#ef4444',
            dangerLight: '#fee2e2'
          },
          fontFamily: {
            inter: ['Inter', 'system-ui', 'sans-serif'],
          },
          boxShadow: {
            'card': '0 4px 20px rgba(0, 0, 0, 0.05)',
            'card-hover': '0 8px 30px rgba(0, 0, 0, 0.1)',
            'modal': '0 10px 40px rgba(0, 0, 0, 0.15)',
          }
        },
      }
    }
  </script>
  
  <!-- 自定义工具类 -->
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .backdrop-blur-sm {
        backdrop-filter: blur(8px);
      }
      .scrollbar-hide {
        scrollbar-width: none;
        -ms-overflow-style: none;
      }
      .scrollbar-hide::-webkit-scrollbar {
        display: none;
      }
      .hover-scale {
        transition: transform 0.25s ease, box-shadow 0.25s ease;
      }
      .hover-scale:hover {
        transform: translateY(-4px) scale(1.05);
      }
      .icon-gradient {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(59, 130, 246, 0.08));
      }
      .category-active {
        background: linear-gradient(135deg, #3b82f6, #60a5fa);
      }
      .btn-primary {
        @apply bg-primary hover:bg-accent text-white transition-all duration-300 rounded-lg font-medium;
      }
      .btn-danger {
        @apply bg-dangerLight hover:bg-danger/15 text-danger hover:text-danger transition-all duration-300 rounded-lg font-medium;
      }
    }
  </style>
  
  <style>
    /* 全局样式 */
    body {
      background-color: #f9fafb;
      background-image: radial-gradient(#e5e7eb 1px, transparent 1px);
      background-size: 20px 20px;
    }
    
    /* 动画效果 */
    .fade-in {
      animation: fadeIn 0.3s ease forwards;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* 平滑滚动 */
    html {
      scroll-behavior: smooth;
    }
    
    /* 输入框焦点动画 */
    .form-input:focus {
      transition: all 0.3s ease;
    }
    
    /* 分类标签动画 */
    .category-btn {
      transition: all 0.2s ease;
    }
  </style>
</head>

<body class="font-inter text-neutral-800 min-h-screen">
  <!-- 顶部导航栏 -->
  <header class="sticky top-0 z-50 bg-white/90 backdrop-blur-sm border-b border-neutral-200 shadow-sm transition-all duration-300">
    <div class="container mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-2">
        <div class="w-10 h-10 rounded-full bg-gradient-to-r from-primary to-secondary flex items-center justify-center shadow-md">
          <i class="fa fa-compass text-white text-xl"></i>
        </div>
        <h1 class="text-xl font-bold text-neutral-900 tracking-tight">QuickNav</h1>
      </div>
      
      <!-- 搜索框 -->
      <div class="hidden md:flex items-center flex-1 max-w-md mx-8">
        <div class="relative w-full">
          <input 
            type="text" 
            id="searchInput"
            placeholder="搜索网站..." 
            class="w-full pl-10 pr-4 py-2.5 rounded-full border border-neutral-200 bg-white focus:outline-none focus:ring-2 focus:ring-primary/40 focus:border-primary focus:shadow-md transition-all"
          >
          <i class="fa fa-search absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400"></i>
        </div>
      </div>
      
      <!-- 功能按钮组 -->
      <div class="flex items-center gap-3">
        <!-- 添加网站按钮 -->
        <button id="addSiteBtn" class="p-2.5 rounded-full hover:bg-neutral-100 transition-all duration-300 shadow-sm hover:shadow">
          <i class="fa fa-plus text-primary text-lg"></i>
        </button>
        
        <!-- 编辑分类按钮 -->
        <button id="editCategoryBtn" class="p-2.5 rounded-full hover:bg-neutral-100 transition-all duration-300 shadow-sm hover:shadow">
          <i class="fa fa-pencil text-primary text-lg"></i>
        </button>
        
        <!-- 主题切换 -->
        <button id="themeToggle" class="p-2.5 rounded-full hover:bg-neutral-100 transition-all duration-300 shadow-sm hover:shadow">
          <i class="fa fa-moon-o text-neutral-700 text-lg"></i>
        </button>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 py-8">
    <!-- 分类导航区域 -->
    <section class="max-w-6xl mx-auto">
      <!-- 分类标签栏 -->
      <div class="flex overflow-x-auto scrollbar-hide gap-3 mb-8 pb-2">
        <button class="category-btn active px-5 py-2.5 rounded-full category-active text-white whitespace-nowrap font-medium shadow-md" data-category="all">全部</button>
        <!-- 分类标签将通过JS动态生成 -->
      </div>
      
      <!-- 网站图标网格 -->
      <div id="websiteGrid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-5">
        <!-- 网站图标将通过JS动态生成 -->
      </div>
      
      <!-- 空状态提示 -->
      <div id="emptyState" class="hidden flex-col items-center justify-center py-20 text-neutral-400">
        <div class="w-20 h-20 rounded-full bg-neutral-100 flex items-center justify-center mb-6 shadow-sm">
          <i class="fa fa-folder-open-o text-4xl text-neutral-300"></i>
        </div>
        <p class="text-xl font-medium mb-3">暂无网站数据</p>
        <p class="text-neutral-500">点击右上角"+"添加你的常用网站</p>
      </div>
    </section>
  </main>

  <!-- 页脚 -->
  <footer class="mt-12 py-6 border-t border-neutral-200 bg-white">
    <div class="container mx-auto px-4 text-center text-neutral-500 text-sm">
      <p>QuickNav - 快速导航平台 © 2025</p>
    </div>
  </footer>

  <!-- 网站操作悬浮窗 (默认隐藏) -->
  <div id="sitePopup" class="fixed hidden bg-white rounded-2xl shadow-modal border border-neutral-100 w-72 p-5 z-50 transform transition-all duration-300" style="top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.95); opacity: 0;">
    <div class="popup-header flex items-center justify-between mb-4">
      <div class="flex items-center gap-2">
        <div id="popupIcon" class="w-10 h-10 rounded-full icon-gradient flex items-center justify-center">
          <i class="fa fa-globe text-primary text-xl"></i>
        </div>
        <h3 id="popupTitle" class="font-bold text-lg text-neutral-900"></h3>
      </div>
      <button id="closePopup" class="p-1.5 rounded-full hover:bg-neutral-100 text-neutral-400 hover:text-neutral-800 transition-colors">
        <i class="fa fa-times"></i>
      </button>
    </div>
    <div class="popup-footer flex gap-3">
      <a id="popupLink" href="" target="_blank" class="flex-1 py-3 btn-primary text-center text-sm">
        <i class="fa fa-external-link mr-1"></i> 立即访问
      </a>
      <button id="deleteSiteBtn" class="flex-1 py-3 btn-danger text-center text-sm">
        <i class="fa fa-trash-o mr-1"></i> 删除
      </button>
    </div>
  </div>

  <!-- 添加网站模态框 (默认隐藏) -->
  <div id="addSiteModal" class="fixed hidden bg-white rounded-2xl shadow-modal border border-neutral-100 w-full max-w-md p-6 z-50 transform transition-all duration-300" style="top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.95); opacity: 0;">
    <div class="modal-header flex items-center justify-between mb-6">
      <h3 class="font-bold text-xl text-neutral-900">添加常用网站</h3>
      <button id="closeAddModal" class="p-1.5 rounded-full hover:bg-neutral-100 text-neutral-400 hover:text-neutral-800 transition-colors">
        <i class="fa fa-times"></i>
      </button>
    </div>
    <form id="addSiteForm">
      <div class="mb-5">
        <label class="block text-sm font-medium text-neutral-700 mb-2">网站名称</label>
        <input type="text" id="siteName" required placeholder="例如：百度" class="w-full px-4 py-3 rounded-lg border border-neutral-200 form-input focus:outline-none focus:ring-2 focus:ring-primary/40 focus:border-primary">
      </div>
      <div class="mb-5">
        <label class="block text-sm font-medium text-neutral-700 mb-2">网站地址</label>
        <input type="url" id="siteUrl" required placeholder="https://www.baidu.com" class="w-full px-4 py-3 rounded-lg border border-neutral-200 form-input focus:outline-none focus:ring-2 focus:ring-primary/40 focus:border-primary">
      </div>
      <div class="mb-5">
        <label class="block text-sm font-medium text-neutral-700 mb-2">选择分类</label>
        <select id="siteCategory" required class="w-full px-4 py-3 rounded-lg border border-neutral-200 form-input focus:outline-none focus:ring-2 focus:ring-primary/40 focus:border-primary appearance-none bg-white bg-no-repeat bg-right pr-10" style="background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2216%22 height=%2216%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%236b7280%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226 9 12 15 18 9%22></polyline></svg>');">
          <!-- 分类选项将通过JS动态生成 -->
        </select>
      </div>
      <div class="mb-6">
        <label class="block text-sm font-medium text-neutral-700 mb-2">选择图标</label>
        <div class="grid grid-cols-6 gap-3 max-h-52 overflow-y-auto scrollbar-hide p-2 border border-neutral-200 rounded-lg bg-neutral-50">
          <!-- 图标选项 -->
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-globe">
            <i class="fa fa-globe text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-search">
            <i class="fa fa-search text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-weixin">
            <i class="fa fa-weixin text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-weibo">
            <i class="fa fa-weibo text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-shopping-bag">
            <i class="fa fa-shopping-bag text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-video-camera">
            <i class="fa fa-video-camera text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-music">
            <i class="fa fa-music text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-book">
            <i class="fa fa-book text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-code">
            <i class="fa fa-code text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-envelope">
            <i class="fa fa-envelope text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-map-marker">
            <i class="fa fa-map-marker text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-calendar">
            <i class="fa fa-calendar text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-github">
            <i class="fa fa-github text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-youtube">
            <i class="fa fa-youtube text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-twitter">
            <i class="fa fa-twitter text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-linkedin">
            <i class="fa fa-linkedin text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-graduation-cap">
            <i class="fa fa-graduation-cap text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-paint-brush">
            <i class="fa fa-paint-brush text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-gamepad">
            <i class="fa fa-gamepad text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-bank">
            <i class="fa fa-bank text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-credit-card">
            <i class="fa fa-credit-card text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-headphones">
            <i class="fa fa-headphones text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-camera">
            <i class="fa fa-camera text-primary text-xl"></i>
          </div>
          <div class="icon-option flex items-center justify-center p-3 rounded-lg hover:bg-white cursor-pointer border-2 border-transparent hover:border-primary/20" data-icon="fa-car">
            <i class="fa fa-car text-primary text-xl"></i>
          </div>
        </div>
        <input type="hidden" id="selectedIcon" value="fa-globe">
      </div>
      <button type="submit" class="w-full py-3.5 btn-primary text-sm md:text-base">
        <i class="fa fa-plus-circle mr-2"></i> 确认添加
      </button>
    </form>
  </div>

  <!-- 编辑分类模态框 (默认隐藏) -->
  <div id="editCategoryModal" class="fixed hidden bg-white rounded-2xl shadow-modal border border-neutral-100 w-full max-w-md p-6 z-50 transform transition-all duration-300" style="top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.95); opacity: 0;">
    <div class="modal-header flex items-center justify-between mb-6">
      <h3 class="font-bold text-xl text-neutral-900">编辑分类</h3>
      <button id="closeCategoryModal" class="p-1.5 rounded-full hover:bg-neutral-100 text-neutral-400 hover:text-neutral-800 transition-colors">
        <i class="fa fa-times"></i>
      </button>
    </div>
    <div class="mb-6">
      <label class="block text-sm font-medium text-neutral-700 mb-3">现有分类</label>
      <div id="categoryList" class="space-y-3 mb-5">
        <!-- 分类项将通过JS动态生成 -->
      </div>
      <div class="flex gap-3">
        <input type="text" id="newCategory" placeholder="添加新分类" class="flex-1 px-4 py-3 rounded-lg border border-neutral-200 form-input focus:outline-none focus:ring-2 focus:ring-primary/40 focus:border-primary">
        <button id="addCategoryBtn" class="px-5 btn-primary whitespace-nowrap">
          <i class="fa fa-plus mr-1"></i> 添加
        </button>
      </div>
    </div>
    <div class="bg-neutral-50 p-3 rounded-lg text-sm text-neutral-500 mb-6">
      <p class="flex items-center gap-2">
        <i class="fa fa-info-circle text-primary"></i>
        提示：删除分类将同时删除该分类下的所有网站
      </p>
    </div>
    <button id="saveCategoryBtn" class="w-full py-3.5 btn-primary text-sm md:text-base">
      <i class="fa fa-save mr-2"></i> 保存修改
    </button>
  </div>

  <!-- 背景遮罩 (默认隐藏) -->
  <div id="overlay" class="fixed inset-0 bg-black/15 backdrop-blur-sm hidden z-40 transition-opacity duration-300"></div>

  <script>
    // 初始化数据 - 从本地存储加载或使用默认数据
    let appData = JSON.parse(localStorage.getItem('quickNavData')) || {
      categories: ['社交媒体', '新闻资讯', '实用工具', '视频娱乐', '办公学习'],
      websites: [
        {
          id: 1,
          name: "微信",
          icon: "fa-weixin",
          category: "社交媒体",
          url: "https://weixin.qq.com/"
        },
        {
          id: 2,
          name: "微博",
          icon: "fa-weibo",
          category: "社交媒体",
          url: "https://weibo.com/"
        },
        {
          id: 3,
          name: "百度",
          icon: "fa-search",
          category: "实用工具",
          url: "https://www.baidu.com/"
        },
        {
          id: 4,
          name: "知乎",
          icon: "fa-question-circle",
          category: "社交媒体",
          url: "https://www.zhihu.com/"
        },
        {
          id: 5,
          name: "腾讯新闻",
          icon: "fa-newspaper-o",
          category: "新闻资讯",
          url: "https://news.qq.com/"
        },
        {
          id: 6,
          name: "网易云音乐",
          icon: "fa-music",
          category: "视频娱乐",
          url: "https://music.163.com/"
        },
        {
          id: 7,
          name: "B站",
          icon: "fa-play-circle",
          category: "视频娱乐",
          url: "https://www.bilibili.com/"
        },
        {
          id: 8,
          name: "淘宝",
          icon: "fa-shopping-bag",
          category: "实用工具",
          url: "https://www.taobao.com/"
        }
      ]
    };

    // DOM元素
    const websiteGrid = document.getElementById('websiteGrid');
    const categoryContainer = document.querySelector('.flex.overflow-x-auto');
    const sitePopup = document.getElementById('sitePopup');
    const overlay = document.getElementById('overlay');
    const closePopup = document.getElementById('closePopup');
    const deleteSiteBtn = document.getElementById('deleteSiteBtn');
    const addSiteBtn = document.getElementById('addSiteBtn');
    const addSiteModal = document.getElementById('addSiteModal');
    const closeAddModal = document.getElementById('closeAddModal');
    const addSiteForm = document.getElementById('addSiteForm');
    const editCategoryBtn = document.getElementById('editCategoryBtn');
    const editCategoryModal = document.getElementById('editCategoryModal');
    const closeCategoryModal = document.getElementById('closeCategoryModal');
    const categoryList = document.getElementById('categoryList');
    const newCategoryInput = document.getElementById('newCategory');
    const addCategoryBtn = document.getElementById('addCategoryBtn');
    const saveCategoryBtn = document.getElementById('saveCategoryBtn');
    const themeToggle = document.getElementById('themeToggle');
    const emptyState = document.getElementById('emptyState');
    const searchInput = document.getElementById('searchInput');
    const siteCategorySelect = document.getElementById('siteCategory');
    const iconOptions = document.querySelectorAll('.icon-option');
    const selectedIconInput = document.getElementById('selectedIcon');
    const popupIcon = document.getElementById('popupIcon');

    // 当前操作的网站ID
    let currentSiteId = null;
    // 当前选中的分类
    let currentCategory = 'all';

    // 初始化页面
    function init() {
      renderCategories();
      renderWebsites('all');
      renderCategoryOptions();
      setupEventListeners();
      checkEmptyState();
      // 加载主题设置
      loadThemeSetting();
    }

    // 保存数据到本地存储
    function saveData() {
      localStorage.setItem('quickNavData', JSON.stringify(appData));
    }

    // 渲染分类标签
    function renderCategories() {
      // 清空现有分类（保留"全部"）
      const allBtn = categoryContainer.querySelector('[data-category="all"]');
      categoryContainer.innerHTML = '';
      categoryContainer.appendChild(allBtn);
      
      // 添加自定义分类
      appData.categories.forEach(category => {
        const categoryBtn = document.createElement('button');
        categoryBtn.className = 'category-btn px-5 py-2.5 rounded-full bg-white border border-neutral-200 hover:border-primary/30 hover:bg-neutral-50 text-neutral-700 whitespace-nowrap font-medium shadow-sm';
        categoryBtn.dataset.category = category;
        categoryBtn.textContent = category;
        
        // 如果是当前选中的分类，设置为激活状态
        if (category === currentCategory) {
          categoryBtn.classList.remove('bg-white', 'border', 'border-neutral-200', 'hover:border-primary/30', 'hover:bg-neutral-50', 'text-neutral-700');
          categoryBtn.classList.add('active', 'category-active', 'text-white', 'shadow-md');
        }
        
        categoryBtn.addEventListener('click', () => {
          switchCategory(category);
        });
        
        categoryContainer.appendChild(categoryBtn);
      });
    }

    // 渲染网站图标
    function renderWebsites(category) {
      websiteGrid.innerHTML = '';
      
      // 筛选网站
      let filteredSites = appData.websites;
      
      if (category !== 'all') {
        filteredSites = filteredSites.filter(site => site.category === category);
      }
      
      // 应用搜索过滤
      if (searchInput && searchInput.value.trim()) {
        const searchTerm = searchInput.value.trim().toLowerCase();
        filteredSites = filteredSites.filter(site => 
          site.name.toLowerCase().includes(searchTerm)
        );
      }
      
      // 渲染网站卡片
      filteredSites.forEach((site, index) => {
        const siteCard = document.createElement('div');
        siteCard.className = 'flex flex-col items-center p-4 rounded-2xl bg-white shadow-card hover:shadow-card-hover border border-neutral-100 hover-scale cursor-pointer fade-in';
        siteCard.dataset.id = site.id;
        // 延迟动画，创建依次出现的效果
        siteCard.style.animationDelay = `${index * 30}ms`;
        
        siteCard.innerHTML = `
          <div class="w-14 h-14 rounded-full icon-gradient flex items-center justify-center mb-3 shadow-sm">
            <i class="fa ${site.icon} text-primary text-2xl"></i>
          </div>
          <span class="text-sm font-medium text-center line-clamp-1 text-neutral-800">${site.name}</span>
        `;
        
        siteCard.addEventListener('click', () => openSitePopup(site));
        websiteGrid.appendChild(siteCard);
      });
      
      checkEmptyState();
    }

    // 渲染分类选择下拉框选项
    function renderCategoryOptions() {
      siteCategorySelect.innerHTML = '';
      
      appData.categories.forEach(category => {
        const option = document.createElement('option');
        option.value = category;
        option.textContent = category;
        siteCategorySelect.appendChild(option);
      });
    }

    // 渲染编辑分类列表
    function renderEditCategoryList() {
      categoryList.innerHTML = '';
      
      appData.categories.forEach((category, index) => {
        const categoryItem = document.createElement('div');
        categoryItem.className = 'flex items-center justify-between p-3 rounded-xl bg-white border border-neutral-200 shadow-sm';
        
        categoryItem.innerHTML = `
          <div class="flex items-center gap-2">
            <div class="w-8 h-8 rounded-full bg-neutral-100 flex items-center justify-center">
              <i class="fa fa-folder text-neutral-500"></i>
            </div>
            <span class="font-medium">${category}</span>
          </div>
          <button class="delete-category-btn p-2 rounded-full hover:bg-dangerLight text-neutral-400 hover:text-danger transition-colors" data-index="${index}">
            <i class="fa fa-trash-o"></i>
          </button>
        `;
        
        categoryList.appendChild(categoryItem);
      });
      
      // 添加删除分类事件监听
      document.querySelectorAll('.delete-category-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const index = parseInt(e.currentTarget.dataset.index);
          deleteCategory(index);
        });
      });
    }

    // 切换分类
    function switchCategory(category) {
      currentCategory = category;
      
      // 更新按钮状态
      document.querySelectorAll('.category-btn').forEach(btn => {
        btn.classList.remove('active', 'category-active', 'text-white', 'shadow-md');
        btn.classList.add('bg-white', 'border', 'border-neutral-200', 'hover:border-primary/30', 'hover:bg-neutral-50', 'text-neutral-700');
        
        if (btn.dataset.category === category) {
          btn.classList.remove('bg-white', 'border', 'border-neutral-200', 'hover:border-primary/30', 'hover:bg-neutral-50', 'text-neutral-700');
          btn.classList.add('active', 'category-active', 'text-white', 'shadow-md');
        }
      });
      
      // 渲染对应分类的网站
      renderWebsites(category);
    }

    // 打开网站操作悬浮窗
    function openSitePopup(site) {
      currentSiteId = site.id;
      
      // 更新悬浮窗内容
      document.getElementById('popupTitle').textContent = site.name;
      document.getElementById('popupLink').href = site.url;
      popupIcon.innerHTML = `<i class="fa ${site.icon} text-primary text-xl"></i>`;
      
      // 显示悬浮窗和遮罩
      overlay.classList.remove('hidden');
      sitePopup.classList.remove('hidden');
      
      // 添加动画效果
      setTimeout(() => {
        overlay.style.opacity = '1';
        sitePopup.style.transform = 'translate(-50%, -50%) scale(1)';
        sitePopup.style.opacity = '1';
      }, 10);
    }

    // 关闭悬浮窗/模态框
    function closeModal(modal) {
      // 添加关闭动画
      overlay.style.opacity = '0';
      modal.style.transform = 'translate(-50%, -50%) scale(0.95)';
      modal.style.opacity = '0';
      
      setTimeout(() => {
        modal.classList.add('hidden');
        overlay.classList.add('hidden');
        // 重置样式
        modal.style.transform = '';
        modal.style.opacity = '';
        overlay.style.opacity = '';
      }, 300);
    }

    // 添加网站
    function addSite(siteData) {
      // 生成唯一ID
      const newId = appData.websites.length > 0 
        ? Math.max(...appData.websites.map(site => site.id)) + 1 
        : 1;
      
      const newSite = {
        id: newId,
        name: siteData.name,
        url: siteData.url,
        category: siteData.category,
        icon: siteData.icon
      };
      
      appData.websites.push(newSite);
      saveData();
      renderWebsites(currentCategory);
      checkEmptyState();
    }

    // 删除网站
    function deleteSite(siteId) {
      appData.websites = appData.websites.filter(site => site.id !== siteId);
      saveData();
      closeModal(sitePopup);
      renderWebsites(currentCategory);
      checkEmptyState();
    }

    // 添加分类
    function addCategory(categoryName) {
      if (!categoryName.trim() || appData.categories.includes(categoryName.trim())) {
        // 显示错误提示
        newCategoryInput.classList.add('border-danger');
        setTimeout(() => {
          newCategoryInput.classList.remove('border-danger');
        }, 1500);
        return; // 空分类或已存在的分类不添加
      }
      
      appData.categories.push(categoryName.trim());
      renderEditCategoryList();
      renderCategoryOptions();
      newCategoryInput.value = '';
      
      // 添加成功动画
      const successIcon = document.createElement('div');
      successIcon.className = 'fixed bottom-4 right-4 bg-green-500 text-white p-3 rounded-full shadow-lg z-50 fade-in';
      successIcon.innerHTML = '<i class="fa fa-check"></i>';
      document.body.appendChild(successIcon);
      
      setTimeout(() => {
        successIcon.style.opacity = '0';
        successIcon.style.transform = 'translateY(10px)';
        setTimeout(() => {
          document.body.removeChild(successIcon);
        }, 300);
      }, 1500);
    }

    // 删除分类
    function deleteCategory(index) {
      if (confirm('确定要删除这个分类吗？删除后该分类下的所有网站也会被删除。')) {
        const categoryToDelete = appData.categories[index];
        
        // 删除该分类下的所有网站
        appData.websites = appData.websites.filter(site => site.category !== categoryToDelete);
        
        // 删除分类
        appData.categories.splice(index, 1);
        
        // 如果当前选中的是被删除的分类，切换到"全部"
        if (currentCategory === categoryToDelete) {
          currentCategory = 'all';
        }
        
        renderEditCategoryList();
        renderCategoryOptions();
      }
    }

    // 检查空状态
    function checkEmptyState() {
      if (appData.websites.length === 0) {
        emptyState.classList.remove('hidden');
        websiteGrid.classList.add('hidden');
      } else {
        emptyState.classList.add('hidden');
        websiteGrid.classList.remove('hidden');
      }
    }

    // 切换主题
    function toggleTheme() {
      const isDark = document.documentElement.classList.toggle('dark');
      
      if (isDark) {
        document.body.style.backgroundColor = '#111827';
        document.body.style.backgroundImage = 'radial-gradient(#1f2937 1px, transparent 1px)';
        themeToggle.innerHTML = '<i class="fa fa-sun-o text-yellow-400 text-lg"></i>';
        localStorage.setItem('theme', 'dark');
      } else {
        document.body.style.backgroundColor = '#f9fafb';
        document.body.style.backgroundImage = 'radial-gradient(#e5e7eb 1px, transparent 1px)';
        themeToggle.innerHTML = '<i class="fa fa-moon-o text-neutral-700 text-lg"></i>';
        localStorage.setItem('theme', 'light');
      }
    }

    // 加载主题设置
    function loadThemeSetting() {
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'dark') {
        document.documentElement.classList.add('dark');
        document.body.style.backgroundColor = '#111827';
        document.body.style.backgroundImage = 'radial-gradient(#1f2937 1px, transparent 1px)';
        themeToggle.innerHTML = '<i class="fa fa-sun-o text-yellow-400 text-lg"></i>';
      } else {
        document.documentElement.classList.remove('dark');
        document.body.style.backgroundColor = '#f9fafb';
        document.body.style.backgroundImage = 'radial-gradient(#e5e7eb 1px, transparent 1px)';
        themeToggle.innerHTML = '<i class="fa fa-moon-o text-neutral-700 text-lg"></i>';
      }
    }

    // 设置事件监听
    function setupEventListeners() {
      // 分类切换
      document.querySelectorAll('.category-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const category = btn.dataset.category;
          switchCategory(category);
        });
      });
      
      // 关闭网站悬浮窗
      closePopup.addEventListener('click', () => {
        closeModal(sitePopup);
      });
      
      // 删除网站
      deleteSiteBtn.addEventListener('click', () => {
        if (currentSiteId !== null) {
          if (confirm('确定要删除这个网站吗？')) {
            deleteSite(currentSiteId);
          }
        }
      });
      
      // 打开添加网站模态框
      addSiteBtn.addEventListener('click', () => {
        addSiteModal.classList.remove('hidden');
        overlay.classList.remove('hidden');
        
        // 重置表单
        addSiteForm.reset();
        selectedIconInput.value = 'fa-globe';
        document.querySelectorAll('.icon-option').forEach(option => {
          option.classList.remove('bg-primary/10', 'border-primary');
          option.classList.add('border-transparent');
        });
        document.querySelector('[data-icon="fa-globe"]').classList.add('bg-primary/10', 'border-primary');
        document.querySelector('[data-icon="fa-globe"]').classList.remove('border-transparent');
        
        // 添加动画效果
        setTimeout(() => {
          overlay.style.opacity = '1';
          addSiteModal.style.transform = 'translate(-50%, -50%) scale(1)';
          addSiteModal.style.opacity = '1';
        }, 10);
      });
      
      // 关闭添加网站模态框
      closeAddModal.addEventListener('click', () => {
        closeModal(addSiteModal);
      });
      
      // 提交添加网站表单
      addSiteForm.addEventListener('submit', (e) => {
        e.preventDefault();
        
        const siteData = {
          name: document.getElementById('siteName').value,
          url: document.getElementById('siteUrl').value,
          category: document.getElementById('siteCategory').value,
          icon: selectedIconInput.value
        };
        
        addSite(siteData);
        closeModal(addSiteModal);
        
        // 显示添加成功提示
        const successIcon = document.createElement('div');
        successIcon.className = 'fixed bottom-4 right-4 bg-green-500 text-white p-3 rounded-full shadow-lg z-50 fade-in';
        successIcon.innerHTML = '<i class="fa fa-check"></i>';
        document.body.appendChild(successIcon);
        
        setTimeout(() => {
          successIcon.style.opacity = '0';
          successIcon.style.transform = 'translateY(10px)';
          setTimeout(() => {
            document.body.removeChild(successIcon);
          }, 300);
        }, 1500);
      });
      
      // 打开编辑分类模态框
      editCategoryBtn.addEventListener('click', () => {
        renderEditCategoryList();
        editCategoryModal.classList.remove('hidden');
        overlay.classList.remove('hidden');
        
        // 添加动画效果
        setTimeout(() => {
          overlay.style.opacity = '1';
          editCategoryModal.style.transform = 'translate(-50%, -50%) scale(1)';
          editCategoryModal.style.opacity = '1';
        }, 10);
      });
      
      // 关闭编辑分类模态框
      closeCategoryModal.addEventListener('click', () => {
        closeModal(editCategoryModal);
      });
      
      // 添加新分类
      addCategoryBtn.addEventListener('click', () => {
        addCategory(newCategoryInput.value);
      });
      
      // 按回车添加分类
      newCategoryInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          addCategory(newCategoryInput.value);
        }
      });
      
      // 保存分类修改
      saveCategoryBtn.addEventListener('click', () => {
        saveData();
        renderCategories();
        renderWebsites(currentCategory);
        closeModal(editCategoryModal);
        
        // 显示保存成功提示
        const successIcon = document.createElement('div');
        successIcon.className = 'fixed bottom-4 right-4 bg-green-500 text-white p-3 rounded-full shadow-lg z-50 fade-in';
        successIcon.innerHTML = '<i class="fa fa-check"></i>';
        document.body.appendChild(successIcon);
        
        setTimeout(() => {
          successIcon.style.opacity = '0';
          successIcon.style.transform = 'translateY(10px)';
          setTimeout(() => {
            document.body.removeChild(successIcon);
          }, 300);
        }, 1500);
      });
      
      // 主题切换
      themeToggle.addEventListener('click', toggleTheme);
      
      // 键盘ESC关闭模态框
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          if (!sitePopup.classList.contains('hidden')) {
            closeModal(sitePopup);
          } else if (!addSiteModal.classList.contains('hidden')) {
            closeModal(addSiteModal);
          } else if (!editCategoryModal.classList.contains('hidden')) {
            closeModal(editCategoryModal);
          }
        }
      });
      
      // 点击遮罩关闭模态框
      overlay.addEventListener('click', () => {
        if (!sitePopup.classList.contains('hidden')) {
          closeModal(sitePopup);
        } else if (!addSiteModal.classList.contains('hidden')) {
          closeModal(addSiteModal);
        } else if (!editCategoryModal.classList.contains('hidden')) {
          closeModal(editCategoryModal);
        }
      });
      
      // 搜索功能
      if (searchInput) {
        searchInput.addEventListener('input', () => {
          renderWebsites(currentCategory);
        });
      }
      
      // 选择图标
      iconOptions.forEach(option => {
        option.addEventListener('click', () => {
          // 移除其他图标的选中状态
          iconOptions.forEach(opt => {
            opt.classList.remove('bg-primary/10', 'border-primary');
            opt.classList.add('border-transparent');
          });
          
          // 设置当前选中图标
          option.classList.add('bg-primary/10', 'border-primary');
          option.classList.remove('border-transparent');
          selectedIconInput.value = option.dataset.icon;
        });
      });
      
      // 输入框获得焦点时的动画
      const formInputs = document.querySelectorAll('.form-input');
      formInputs.forEach(input => {
        input.addEventListener('focus', () => {
          input.parentElement.classList.add('scale-100');
        });
        input.addEventListener('blur', () => {
          input.parentElement.classList.remove('scale-100');
        });
      });
    }

    // 页面加载完成后初始化
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
